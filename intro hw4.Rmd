---
title: "Homework #4"
author: "Fan Yang, fy2232"
date: "November 24, 2017"
output:
  pdf_document: default
  html_document: default
---


```{r, echo = FALSE}
set.seed(1) # Please don't remove this code!
```


# Part 1

i. 
```{r}
ahat = 2.654
xmin = 407760
f <- function(x, a = ahat, x_min = xmin){
  return ((a-1)/x_min*(x/x_min)^(-a))
}
xi <- 407760:1000000
plot(xi, f(xi),xlab = "x",ylab="f(x)")


```


ii. 
$F^{-1}(u)=x_{min}(1-u)^{\frac{1}{-a+1}}$
```{r}
upper.income <- function(u, a = ahat,x_min=xmin ){
  return (x_min*(1-u)^(1/(1-a)))
}
upper.income(0.5)

```

iii.
```{r}
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
  geom_histogram(aes(x = draws, y = ..density..)) +
  geom_density(aes(x = draws)) + 
  geom_smooth(aes(x = xi, y = f(xi)))

```

iv.
```{r}
median(draws)
upper.income(0.5)

```

# Part 2

