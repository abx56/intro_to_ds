geom_smooth(aes(x = xi, y = f(xi)))
#geom_vline(xintercept = mean(baseball$OBP))
median(draws)
upper.income(0.5)
moretti <- read.table("moretti.csv",header = T, as.is = T)
names(moretti)
dim(moretti)
prod(5)
factorial(5)
moretti <- read.table("moretti.csv",header = T, as.is = T)
poisLoglik <- function(lambda, data){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
poisLoglik(1,c(1,0,0,1,1))
moretti <- read.table("moretti.csv",header = T, as.is = T)
poisLoglik <- function(lambda, data){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
poisLoglik(1,c(0,0,0,0,0))
moretti <- read.table("moretti.csv",header = T, as.is = T)
poisLoglik <- function(lambda, data){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
poisLoglik(1,c(0,0,0,0))
moretti <- read.table("moretti.csv",header = T, as.is = T)
poisLoglik <- function(lambda, data){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
poisLoglik(2,c(0,0,0,0))
moretti <- read.table("moretti.csv",header = T, as.is = T)
poisLoglik <- function(lambda, data){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
poisLoglik(1,c(1,0,0,1,1))
moretti
count_new_genres <- function(year){
return (sum(moretti$Begin.==year))
}
count_new_genres(1803)
count_new_genres(1850)
moretti$Begin.==1850
moretti <- read.table("moretti.csv",header = T)
poisLoglik <- function(lambda, data){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
poisLoglik(1,c(1,0,0,1,1))
moretti
moretti <- read.table("moretti.csv",header = T, as.is = T)
poisLoglik <- function(lambda, data){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
poisLoglik(1,c(1,0,0,1,1))
moretti
moretti <- read.table("moretti.csv",header = T, as.is = T)
moretti$Begin. <- as.numeric(moretti$Begin.)
poisLoglik <- function(lambda, data){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
poisLoglik(1,c(1,0,0,1,1))
moretti
moretti <- read.csv("moretti.csv",header = T, as.is = T)
moretti$Begin. <- as.numeric(moretti$Begin.)
moretti <- read.csv("moretti.csv",header = T, as.is = T)
poisLoglik <- function(lambda, data){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
poisLoglik(1,c(1,0,0,1,1))
moretti
count_new_genres <- function(year){
return (sum(moretti$Begin==year))
}
moretti$Begin.==1850
count_new_genres(1850)
count_new_genres <- function(year){
return (sum(moretti$Begin==year))
}
count_new_genres(1803)
count_new_genres(1850)
new_genres <- count_new_genres(1740:1900)
new_genres
new_genres <- count_new_genres(c(1740:1900))
new_genres
c(1740:1900)
new_genres <- count_new_genres(c(1740:1900))
x<-1740:1900
new_genres <- count_new_genres(x)
x
new_genres = c()
new_genres <- count_new_genres(x)
new_genres = c()
new_genres = count_new_genres(x)
new_genres = sapply(1740:1900,count_new_genres)
new_genres
new_genres[1803-1740+1]
new_genres[1850-1740+1]
new_genres = sapply(1740:1900,count_new_genres)
1803-1740+1;1850-1740+1
new_genres[1803-1740+1]
new_genres[1850-1740+1]
new_genres = sapply(1740:1900,count_new_genres)
1803-1740+1;1850-1740+1
new_genres[64]
new_genres[111]
new_genres[64]==count_new_genres(1803)
new_genres[111]==count_new_genres(1850)
ggplot() +
geom_smooth(aes(x = new_genres, y = poisLoglik(x)))
ggplot() +
geom_smooth(aes(x = new_genres, y = poisLoglik(new_genres)))
ggplot() +
geom_smooth(aes(x = new_genres, y = poisLoglik(2,new_genres)))
lambda <- c(0:300)/100
ggplot() +
geom_smooth(aes(x =lambda , y = poisLoglik(lambda,new_genres)))
lambda
poisLoglik(lambda,new_genres)
new_genres
plot(lambda,poisLoglik(lambda,new_genres))
lambda <- c(0:300)/100
poisLog <- sapply(lambda, poisLoglik, data=new_genres)
ggplot() +
geom_smooth(aes(x =lambda , y = poisLog))
lambda <- c(0:300)/100
poisLog <- sapply(lambda, poisLoglik, data=new_genres)
ggplot() +
geom_point(aes(x =lambda , y = poisLog))
geom_smooth(aes(x =lambda , y = poisLog))
lambda <- c(0:300)/100
poisLog <- sapply(lambda, poisLoglik, data=new_genres)
ggplot() +
geom_point(aes(x =lambda , y = poisLog)) +
geom_smooth(aes(x =lambda , y = poisLog))
lambda <- c(0:3000)/1000
poisLog <- sapply(lambda, poisLoglik, data=new_genres)
ggplot() +
geom_point(aes(x =lambda , y = poisLog)) +
geom_smooth(aes(x =lambda , y = poisLog))
lambda <- c(0:3000)/1000
poisLog <- sapply(lambda, poisLoglik, data=new_genres)
ggplot() +
geom_point(aes(x =lambda , y = poisLog))
?nlm
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,0)
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,1)
f <- function(x) sum((x-1:length(x))^2)
nlm(f, c(10,10))
f(10)
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(0,0))
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(1,1))
f <- function(x) sum((x-1:length(x))^2)
nlm(f, c(10,10))
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(1))
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(0.1))
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(0.124))
lambda <- c(0:3000)/1000
poisLog <- sapply(lambda, poisLoglik, data=new_genres)
ggplot() +
geom_point(aes(x =lambda , y = poisLog))
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (-sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(0.124))
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (-sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(0))
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(-poisLoglik2,c(1))
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (-sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(1))
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (-sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(1))$estimate
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (-sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(1),na.rm=TRUE)$estimate
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (-sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(1))$estimate
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (100000-sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(1))$estimate
nlm(poisLoglik2,c(1))
lambda <- c(0:3000)/1000
poisLoglik2 <- function(lambda, data=new_genres){
return (-sum(log(lambda^data*exp(-lambda)/factorial(data))))
}
nlm(poisLoglik2,c(1))$minimum
nlm(poisLoglik2,c(1))$estimate
```{r}
?diff
intergenre_intervals <- diff(sort(moretti$Begin))
intergenre_intervals
sort(moretti$Begin
)
intergenre_intervals
intergenre_intervals <- diff(sort(moretti$Begin))
length(intergenre_intervals)
intergenre_intervals <- diff(sort(moretti$Begin))
mean(intergenre_intervals)
sd(intergenre_intervals)
cov(intergenre_intervals)
intergenre_intervals <- diff(sort(moretti$Begin))
mean(intergenre_intervals)
sd(intergenre_intervals)
cor(intergenre_intervals)
intergenre_intervals <- diff(sort(moretti$Begin))
mean(intergenre_intervals)
sd(intergenre_intervals)
#cov(intergenre_intervals)
sd(intergenre_intervals)/mean(intergenre_intervals)
pois_draws <- rpois(161,0.273)
pois_draws
?for
{}
?for loop
??for
pois_f <- function(num_new_genres){
yearinter = c()
for (i in c(1:length(num_new_genres))){
yearinter <- c(yearinter,rep(num_new_genres[i],i))
}
}
pois_f <- function(num_new_genres){
yearinter = c()
for (i in c(1:length(num_new_genres))){
yearinter <- c(yearinter,rep(num_new_genres[i],i))
}
}
pois_f(new_genres)
pois_f <- function(num_new_genres){
yearinter = c()
for (i in c(1:length(num_new_genres))){
yearinter <- c(yearinter,rep(num_new_genres[i],i))
}
return (yearinter)
}
pois_f(new_genres)
pois_f <- function(num_new_genres){
yearinter = c()
for (i in c(1:length(num_new_genres))){
yearinter <- c(yearinter,i,rep(num_new_genres[i]))
}
return (yearinter)
}
pois_f(new_genres)
pois_f <- function(num_new_genres){
yearinter = c()
for (i in c(1:length(num_new_genres))){
yearinter <- c(yearinter,rep(i,num_new_genres[i]))
}
return (yearinter)
}
pois_f(new_genres)
pois_f <- function(num_new_genres){
yearinter = c()
for (i in c(1:length(num_new_genres))){
yearinter <- c(yearinter,rep(i,num_new_genres[i]))
}
return (diff(yearinter))
}
pois_f(new_genres)
pois_f <- function(num_new_genres){
yearinter = c()
for (i in c(1:length(num_new_genres))){
yearinter <- c(yearinter,rep(i,num_new_genres[i]))
}
return (diff(yearinter))
}
intergenre_intervals == pois_f(new_genres)
pois_f <- function(num_new_genres){
yearinter = c()
for (i in c(1:length(num_new_genres))){
yearinter <- c(yearinter,rep(i,num_new_genres[i]))
}
return (diff(yearinter))
}
all(intergenre_intervals == pois_f(new_genres))
pois_draws
new_genres
simu_pois <- function(num.years,mean.genres){
interv <- pois_f(num.years)
coeffov <- sd(interv) / mean.genres
return (interv,coeffov)
}
simu_pois <- function(num.years,mean.genres){
interv <- pois_f(num.years)
coeffov <- sd(interv) / mean.genres
return (interv,coeffov)
}
simu_pois(pois_draws,0.273)
simu_pois <- function(num.years,mean.genres){
interv <- pois_f(num.years)
coeffov <- sd(interv) / mean.genres
return (c(interv,coeffov))
}
simu_pois(pois_draws,0.273)
simu_pois <- function(num.years,mean.genres){
interv <- pois_f(num.years)
coeffov <- sd(interv) / mean.genres
return (data.frame(interv,coeffov))
}
simu_pois(pois_draws,0.273)
simu_pois <- function(num.years,mean.genres){
interv <- pois_f(num.years)
coeffov <- sd(interv) / mean.genres
return (data.frame(interval = interv,coefficient_of_variation=coeffov))
}
simu_pois(pois_draws,0.273)
simu_pois <- function(num.years,mean.genres){
interv <- pois_f(num.years)
coeffov <- sd(interv) / mean.genres
return (data.frame(intervals = interv,coefficient_of_variation=coeffov))
}
simu_pois(pois_draws,0.273)
simu_pois <- function(num.years,mean.genres){
interv <- pois_f(num.years)
coeffov <- sd(interv) / mean.genres
return (list(intervals = interv,coefficient_of_variation=coeffov))
}
simu_pois(pois_draws,0.273)
coeffofv <- c()
for (i in 1:10000){
draws_samp <- rpois(161,0.273)
coeffofv[i] <- simu_pois(draws_samp,0.273)$coefficient_of_variation
}
coeffofv_Moretti <- sd(intergenre_intervals) / mean(intergenre_intervals)
sum(coeffofv>coeffofv_Moretti) / length(coeffofv)
coeffofv
coeffofv_Moretti
simu_pois <- function(num.years,mean.genres){
interv <- pois_f(num.years)
coeffov <- sd(interv) / mean.genres
print (sd(interv))
return (list(intervals = interv,coefficient_of_variation=coeffov))
}
simu_pois(pois_draws,0.273)
intergenre_intervals
simu_pois <- function(num.years,mean.genres){
pois_draws <- rpois(num.years,mean.genres)
interv <- pois_f(pois_draws)
coeffov <- sd(interv) / mean(interv)
return (list(intervals = interv,coefficient_of_variation=coeffov))
}
simu_pois(161,0.273)
coeffofv <- c()
for (i in 1:10000){
coeffofv[i] <- simu_pois(161,0.273)$coefficient_of_variation
}
coeffofv_Moretti <- sd(intergenre_intervals) / mean(intergenre_intervals)
sum(coeffofv>coeffofv_Moretti) / length(coeffofv)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..)) +
geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi)))
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..)) +
geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi))) +
xlim(0,e+07)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..)) +
geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi))) +
xlim(0,10^7)
ahat = 2.654
xmin = 407760
f <- function(x, a = ahat, x_min = xmin){
return ((a-1)/x_min*(x/x_min)^(-a))
}
xi <- 407760:1000000
plot(xi, f(xi),xlab = "x",ylab="f(x)")
upper.income <- function(u, a = ahat,x_min=xmin ){
return (x_min*(1-u)^(1/(1-a)))
}
upper.income(0.5)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..)) +
geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi))) +
xlim(0,10^7)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..)) +
#geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi))) +
xlim(0,10^7)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..)) +
#geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi))) +
xlim(0,5*10^6)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..)) +
#geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi),col='red')) +
xlim(0,5*10^6)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..,col='pink')) +
#geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi),col='blue')) +
xlim(0,5*10^6)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..,col='pink')) +
#geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi),col='blue')) +
xlim(0,5*10^6)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..,col='pink')) +
#geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi),col='blue')) +
xlim(0,10^6)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..,col='pink')) +
#geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi),col='blue')) +
xlim(3*10^5,2*10^6)
?co
?col
?color
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..,col='blue')) +
#geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi),col='green')) +
xlim(3*10^5,2*10^6)
library(ggplot2)
samp_p <- runif(1000)
draws <- upper.income(samp_p)
ggplot() +
geom_histogram(aes(x = draws, y = ..density..,col="pink")) +
#geom_density(aes(x = draws)) +
geom_smooth(aes(x = xi, y = f(xi),col="blue")) +
xlim(3*10^5,2*10^6)
