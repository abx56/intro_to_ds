#test.error
#pred = KNNclass(test[5,2:6] , K=50)
predd$dists
class(predd$dists)
pred = c()
for (i in 1:nrow(test)){
predd = KNNclass(as.numeric(test[i,2:6]) , K=50)
class(predd$dists)
}
#test.error = sum(pred!=test$Direction) / nrow(test)
#test.error
#pred = KNNclass(test[5,2:6] , K=50)
pred = c()
for (i in 1:nrow(test)){
predd = KNNclass(as.numeric(test[i,2:6]) , K=50)
print(predd$dists)
}
pred = c()
for (i in 1:nrow(test)){
pred[i] = KNNclass(as.numeric(test[i,2:6]) , K=50)
}
test.error = sum(pred!=test$Direction) / nrow(test)
test.error
#pred = KNNclass(test[5,2:6] , K=50)
KNNclass <- function(Lag.new, K = 5,
Lag = cbind(Weekly$Lag1,Weekly$Lag2,Weekly$Lag3,Weekly$Lag4,Weekly$Lag5),
Direction = Weekly$Direction) {
n <- length(Lag[,1])
stopifnot(length(Lag[,2]) == n, length(Lag[,3]) == n,length(Lag[,4]) == n,
length(Lag[,5]) == n, length(Lag.new) == 5, K <= n)
dists      <- sqrt((Lag[,1]-Lag.new[1])^2 + (Lag[,2]-Lag.new[2])^2 + (Lag[,3]-Lag.new[3])^2
+ (Lag[,4]-Lag.new[4])^2 + (Lag[,5]-Lag.new[5])^2)
neighbors  <- order(dists)[1:K]
neighb.dir <- Direction[neighbors]
choice     <- names(which.max(table(neighb.dir)))
return(choice)
}
pred = c()
for (i in 1:nrow(test)){
pred[i] = KNNclass(as.numeric(test[i,2:6]) , K=50)
}
test.error = sum(pred!=test$Direction) / nrow(test)
test.error
#pred = KNNclass(test[5,2:6] , K=50)
pred = c()
for (i in 1:nrow(test)){
pred[i] = KNNclass(as.numeric(test[i,2:6]) , K=3)
}
test.error = sum(pred!=test$Direction) / nrow(test)
test.error
#pred = KNNclass(test[5,2:6] , K=50)
train <- Weekly[(Weekly$Year>=1990&Weekly$Year<=2008),]
test <- Weekly[(Weekly$Year>=2009&Weekly$Year<=2010),]
pred = c()
for (i in 1:nrow(test)){
pred[i] = KNNclass(as.numeric(test[i,2:6]))
}
test.error = sum(pred!=test$Direction) / nrow(test)
test.error
pred = c()
for (i in 1:nrow(test)){
pred[i] = KNNclass(as.numeric(test[i,2:6]) , K=3)
}
test.error2 = sum(pred!=test$Direction) / nrow(test)
test.error2
?sort
?order
order(9:1)
order(10:2)
rank(10:2)
quakes <- readLines("NCEDC_Search_Results.html", warn = FALSE)
nrow(quakes)
dim(quakes)
class(quakes)
quakes
length(quakes)
quakes <- readLines("NCEDC_Search_Results.html", warn = FALSE)
length(quakes)
nchar(quakes)
quakes <- readLines("NCEDC_Search_Results.html", warn = FALSE)
length(quakes)
sum(nchar(quakes))
which.max(nchar(quakes))
max(nchar(quakes))
schedual <- readLines("NetsSchedule.html", warn = FALSE)
length(schedual)
sum(nchar(schedual))
max(nchar(schedual))
grep("<td>[M,T,W,F,S]\\s.*[0-9]</td>", schedual)
grep(">[M,T,W,F,S]\\s.*[0-9]<", schedual)
grep("Khloe Lewis",data)
grep(">M\\s.*[0-9]<", schedual)
grep(">M\s.*[0-9]<", schedual)
grep(">[A-Z]\\s.*[0-9]<", schedual)
grep("a[a-z]", "Alabama")
schedual
schedual[321]
grep("<td colspan=", schedual)
length(grep("<td colspan=", schedual))
length(grep("&nbsp;</td>", schedual))
grep("&nbsp;</td>", schedual)
length(grep("class="team-name">", schedual))
length(grep("></a></li><li class=", schedual))
length(grep("available from", schedual))
grep("available from", schedual)
reg <- ">[A-Z]\\s.*[0-9]<"
length(grep(reg, schedual))
reg <- ">[A-Z].*[0-9]<"
length(grep(reg, schedual))
reg <- "<td>[A-Z].*[0-9]<td>"
length(grep(reg, schedual))
reg <- "<td>[A-Z].*[0-9]</td>"
length(grep(reg, schedual))
grep(reg, schedual)
r       <- regexpr(reg, schedual)
date <- regmatches(schedual, r)
date <- substring(date, 4, nchar(date) - 5)
head(date)
r       <- regexpr(reg, schedual)
date <- regmatches(schedual, r)
date <- substring(date, 5, nchar(date) - 4)
head(date)
r       <- regexpr(reg, schedual)
date <- regmatches(schedual, r)
date <- substring(date, 5, nchar(date) - 5)
head(date)
regtime <- "<td>[0-9].*M</td>"
rtime       <- regexpr(regtime, schedual)
time <- regmatches(schedual, rtime)
time <- substring(date, 5, nchar(date) - 5)
head(date)
regtime <- "<td>[0-9].*M</td>"
rtime       <- regexpr(regtime, schedual)
time <- regmatches(schedual, rtime)
time <- substring(time, 5, nchar(time) - 5)
head(time)
length(time)
reghome <- "<li class= \"game-status\">.*</li>"
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li class= \"game-status\">","",home)
head(time)
head(home)
home <- gsub("<li class= \"game-status\">",".",home)
head(home)
reghome <- "<li class= \"game-status\">.*</li>"
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home
reghome <- "class= \"game-status\">.*</li>"
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li class= \"game-status\">",".",home)
head(home)
reghome <- "class=\"game-status\">.*</li>"
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li class= \"game-status\">",".",home)
head(home)
reghome <- "<li\sclass=\"game-status\">.*</li>"
reghome <- "<li\s class=\"game-status\">.*</li>"
reghome <- "<li\\s class=\"game-status\">.*</li>"
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li class= \"game-status\">",".",home)
head(home)
reghome <- "<li\\sclass=\"game-status\">.*</li>"
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li class= \"game-status\">",".",home)
head(home)
reghome <- "<li\\sclass=\"game-status\">.*</li>"
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li\\sclass=\"game-status\">.*</li>","",home)
head(home)
reghome <- "<li\\sclass=\"game-status\">.*</li>"
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li\\sclass=\"game-status\">","",home)
head(home)
reghome <- "<li\\sclass=\"game-status\">.*<"
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li\\sclass=\"game-status\">","",home)
head(home)
reghome <- "<li\\sclass=\"game-status\">.<"
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li\\sclass=\"game-status\">","",home)
head(home)
reghome <- "<li\\sclass=\"game-status\">."
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li\\sclass=\"game-status\">","",home)
head(home)
temp <- gsub("@",1,home)
temp
reghome <- "<li\\sclass=\"game-status\">."
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li\\sclass=\"game-status\">@","1",home)
home <- gsub("<li\\sclass=\"game-status\">vs","0",home)
head(home)
reghome <- "<li\\sclass=\"game-status\">."
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li\\sclass=\"game-status\">@","1",home)
home <- gsub("<li\\sclass=\"game-status\">v","0",home)
head(home)
reghome <- "<li\\sclass=\"game-status\">."
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li\\sclass=\"game-status\">@",1,home)
home <- gsub("<li\\sclass=\"game-status\">v",0,home)
head(home)
class(home)
home <- as.numeric(home)
sum(home)
sum(home==0)
regopponent <- ">[A-Z].*[a-z]</a>"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "\">[A-Z].*[a-z]</a></li>"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "/.*\">[A-Z].*[a-z]</a></li>"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "href=.*\""
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "href=.*\"><img src"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "href=.*\">[A-Z].*[a-z]</a></li>"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "\">[A-Z].*[a-z]</a></li>"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "\">[A-Z].*[a-z]</a></li></ul>"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
#regopponent <- "class=\"team-name\">.*>[A-Z]"
regopponent <- "/name/.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
#regopponent <- "class=\"team-name\">.*>[A-Z]"
regopponent <- "/name/.*\">[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/.*\"", ropponent)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/.*>[A-Z], ropponent)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/.*>[A-Z]", ropponent)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/.*>[A-Z]", ropponent)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
#ropponent      <- regexpr("/name/.*>[A-Z]", ropponent)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
rawopponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/.*>[A-Z]", rawopponent)
opponent <- regmatches(rawopponent, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
rawopponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/", rawopponent)
opponent <- regmatches(rawopponent, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
rawopponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("name", rawopponent)
opponent <- regmatches(rawopponent, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
opponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*\">[A-Z]"
opponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
reghome <- "<li\\sclass=\"game-status\">."
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li\\sclass=\"game-status\">@","1",home)
home <- gsub("<li\\sclass=\"game-status\">v","0",home)
home <- as.numeric(home)
sum(home)
regopponent <- "class=\"team-name\""
opponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "<li\\sclass=\"team-name\">"
opponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "<li\\sclass=\"team-name\">"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*/","",opponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*/","",opponent)
opponent <- substring(opponent, 1, nchar(opponent) - 4)
head(opponent)
nets <- data.frame(date,time,opponent,home)
nets <- data.frame(date,time,opponent,home)
head(nets,10)
nets <- data.frame(date,time,opponent,home)
nets[1:10,]
nets <- data.frame(date,time,opponent,home)
nets[1:10,1:4]
dim(nets)
nets$date[9]
regtime <- "<td>[0-9].*M</td><td><ul"
rtime       <- regexpr(regtime, schedual)
time <- regmatches(schedual, rtime)
time <- substring(time, 5, nchar(time) - 10)
head(time)
regtime <- "<td>[0-9].*M</td>"
rtime       <- regexpr(regtime, schedual)
time <- regmatches(schedual, rtime)
time <- substring(time, 5, nchar(time) - 5)
head(time)
regdate <- "<td>[A-Z].*[0-9]</td><td><ul"
length(grep(regdate, schedual))
grep(regdate, schedual)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 5, nchar(date) - 10)
head(date)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 5, nchar(date) - 12)
head(date)
regdate <- "><td>[A-Z].*[0-9]</td><td><ul"
regdate <- "><td>[A-Z].*[0-9]</td><td><ul"
length(grep(regdate, schedual))
grep(regdate, schedual)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 5, nchar(date) - 12)
head(date)
regdate <- "><td>[A-Z].{9}[0-9]</td>"
length(grep(regdate, schedual))
grep(regdate, schedual)
regdate <- "><td>[A-Z].{8}[0-9].</td>"
length(grep(regdate, schedual))
grep(regdate, schedual)
regdate <- "><td>[A-Z].*[0-9]</td><td><ul\\sclass"
length(grep(regdate, schedual))
grep(regdate, schedual)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 5, nchar(date) - 12)
head(date)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 1, nchar(date) - 12)
head(date)
regdate <- ">[A-Z].{3},.*[0-9]</td><td><ul\\sclass"
length(grep(regdate, schedual))
grep(regdate, schedual)
regdate <- ">[A-Z].{3}\,.*[0-9]</td><td><ul\\sclass"
regdate <- ">[A-Z].{2},.*[0-9]</td><td><ul\\sclass"
length(grep(regdate, schedual))
grep(regdate, schedual)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 1, nchar(date) - 12)
head(date)
regdate <- ">[A-Z].{2},.*[0-9]<"
length(grep(regdate, schedual))
grep(regdate, schedual)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 1, nchar(date) - 12)
head(date)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 2, nchar(date) - 1)
head(date)
head(date,20)
nets <- data.frame(date,time,opponent,home)
nets[1:10,1:4]
head(nets,10)
head(opponent,10)
length(opponent)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#opponent <- gsub("class.*/","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/[a-z]","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/","",opponent)
opponent <- gsub("\.*","",opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/","",opponent)
opponent <- gsub("\ .*","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/","",opponent)
opponent <- gsub("\ \">.*","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/","",opponent)
opponent <- gsub("\">.*","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
head(opponent,10)
nets <- data.frame(date,time,opponent,home)
max(nchar(nets))
which.max(nchar(nets))
nets$date[1]
max(nchar(nets$date))
