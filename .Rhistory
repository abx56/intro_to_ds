regopponent <- "href=.*\""
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "href=.*\"><img src"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "href=.*\">[A-Z].*[a-z]</a></li>"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "\">[A-Z].*[a-z]</a></li>"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
head(opponent)
regopponent <- "\">[A-Z].*[a-z]</a></li></ul>"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
#regopponent <- "class=\"team-name\">.*>[A-Z]"
regopponent <- "/name/.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
#regopponent <- "class=\"team-name\">.*>[A-Z]"
regopponent <- "/name/.*\">[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/.*\"", ropponent)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/.*>[A-Z], ropponent)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/.*>[A-Z]", ropponent)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/.*>[A-Z]", ropponent)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
#ropponent      <- regexpr("/name/.*>[A-Z]", ropponent)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
rawopponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/.*>[A-Z]", rawopponent)
opponent <- regmatches(rawopponent, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
rawopponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("/name/", rawopponent)
opponent <- regmatches(rawopponent, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
rawopponent      <- regexpr(regopponent, schedual)
ropponent      <- regexpr("name", rawopponent)
opponent <- regmatches(rawopponent, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
opponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*\">[A-Z]"
opponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
reghome <- "<li\\sclass=\"game-status\">."
rhome      <- regexpr(reghome, schedual)
home <- regmatches(schedual, rhome)
home <- gsub("<li\\sclass=\"game-status\">@","1",home)
home <- gsub("<li\\sclass=\"game-status\">v","0",home)
home <- as.numeric(home)
sum(home)
regopponent <- "class=\"team-name\""
opponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "<li\\sclass=\"team-name\">"
opponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "<li\\sclass=\"team-name\">"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*/","",opponent)
#time <- substring(time, 3, nchar(time) - 9)
head(opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*/","",opponent)
opponent <- substring(opponent, 1, nchar(opponent) - 4)
head(opponent)
nets <- data.frame(date,time,opponent,home)
nets <- data.frame(date,time,opponent,home)
head(nets,10)
nets <- data.frame(date,time,opponent,home)
nets[1:10,]
nets <- data.frame(date,time,opponent,home)
nets[1:10,1:4]
dim(nets)
nets$date[9]
regtime <- "<td>[0-9].*M</td><td><ul"
rtime       <- regexpr(regtime, schedual)
time <- regmatches(schedual, rtime)
time <- substring(time, 5, nchar(time) - 10)
head(time)
regtime <- "<td>[0-9].*M</td>"
rtime       <- regexpr(regtime, schedual)
time <- regmatches(schedual, rtime)
time <- substring(time, 5, nchar(time) - 5)
head(time)
regdate <- "<td>[A-Z].*[0-9]</td><td><ul"
length(grep(regdate, schedual))
grep(regdate, schedual)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 5, nchar(date) - 10)
head(date)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 5, nchar(date) - 12)
head(date)
regdate <- "><td>[A-Z].*[0-9]</td><td><ul"
regdate <- "><td>[A-Z].*[0-9]</td><td><ul"
length(grep(regdate, schedual))
grep(regdate, schedual)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 5, nchar(date) - 12)
head(date)
regdate <- "><td>[A-Z].{9}[0-9]</td>"
length(grep(regdate, schedual))
grep(regdate, schedual)
regdate <- "><td>[A-Z].{8}[0-9].</td>"
length(grep(regdate, schedual))
grep(regdate, schedual)
regdate <- "><td>[A-Z].*[0-9]</td><td><ul\\sclass"
length(grep(regdate, schedual))
grep(regdate, schedual)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 5, nchar(date) - 12)
head(date)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 1, nchar(date) - 12)
head(date)
regdate <- ">[A-Z].{3},.*[0-9]</td><td><ul\\sclass"
length(grep(regdate, schedual))
grep(regdate, schedual)
regdate <- ">[A-Z].{3}\,.*[0-9]</td><td><ul\\sclass"
regdate <- ">[A-Z].{2},.*[0-9]</td><td><ul\\sclass"
length(grep(regdate, schedual))
grep(regdate, schedual)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 1, nchar(date) - 12)
head(date)
regdate <- ">[A-Z].{2},.*[0-9]<"
length(grep(regdate, schedual))
grep(regdate, schedual)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 1, nchar(date) - 12)
head(date)
rdate       <- regexpr(regdate, schedual)
date <- regmatches(schedual, rdate)
date <- substring(date, 2, nchar(date) - 1)
head(date)
head(date,20)
nets <- data.frame(date,time,opponent,home)
nets[1:10,1:4]
head(nets,10)
head(opponent,10)
length(opponent)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
#opponent <- gsub("class.*/","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/[a-z]","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/","",opponent)
opponent <- gsub("\.*","",opponent)
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/","",opponent)
opponent <- gsub("\ .*","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/","",opponent)
opponent <- gsub("\ \">.*","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
regopponent <- "class=\"team-name\">.*>[A-Z]"
ropponent      <- regexpr(regopponent, schedual)
opponent <- regmatches(schedual, ropponent)
opponent <- gsub("class.*[a-z]/","",opponent)
opponent <- gsub("\">.*","",opponent)
#opponent <- substring(opponent, 1, nchar(opponent) - 4)
#head(opponent,10)
opponent[10]
head(opponent,10)
nets <- data.frame(date,time,opponent,home)
max(nchar(nets))
which.max(nchar(nets))
nets$date[1]
max(nchar(nets$date))
wtid <- read.csv("wtid-report.csv", header = TRUE)
wtid <- wtid[-Country]
wtid <- wtid[-'Country']
wtid <- wtid[-1]
names(wtid)
wtid <- read.csv("wtid-report.csv", header = TRUE)
wtid <- data.frame(year=wtid$Year,P99=wtid$P99.income.threshold,
P99.5=wtid$P99.5.income.threshold,
P99.9=wtid$P99.9.income.threshold)
names(wtid)
wtid <- read.csv("wtid-report.csv", header = TRUE)
wtid <- data.frame(year=wtid$Year,P99=wtid$P99.income.threshold,
P99.5=wtid$P99.5.income.threshold,
P99.9=wtid$P99.9.income.threshold)
wtid$P99[wtid$year=1993]
wtid <- read.csv("wtid-report.csv", header = TRUE)
wtid <- data.frame(year=wtid$Year,P99=wtid$P99.income.threshold,
P99.5=wtid$P99.5.income.threshold,
P99.9=wtid$P99.9.income.threshold)
wtid$P99[wtid$year==1993]
wtid$P99.5[wtid$year==1942]
?ggplot
install.packages('ggplot2')
library(ggplot2)
ggplot(P99,year,data=wtid)
ggplot(P99~year,data=wtid)
ggplot(wtid$P99,wtid$year)
ggplot(data = wtid) +
geom_point(mapping = aes(x = P99, y = year))
ggplot(data = wtid) +
geom_point(mapping = aes(x = P99, y = year)) +
geom_smooth(mapping = aes(x = P99, y = year))
ggplot(data = wtid) +
geom_point(mapping = aes(x = P99, y = year), color = "purple") +
geom_smooth(mapping = aes(x = P99, y = year), color = "purple")
geom_point(mapping = aes(x = P99.9, y = year), color = "blue")) +
geom_point(mapping = aes(x = P99.9, y = year), color = "blue") +
geom_smooth(mapping = aes(x = P99.9, y = year), color = "blue"))
ggplot(data = wtid) +
geom_point(mapping = aes(x = P99, y = year), color = "purple") +
geom_smooth(mapping = aes(x = P99, y = year), color = "purple")+
geom_point(mapping = aes(x = P99.5, y = year), color = "red") +
geom_smooth(mapping = aes(x = P99.5, y = year), color = "red")+
geom_point(mapping = aes(x = P99.9, y = year), color = "blue") +
geom_smooth(mapping = aes(x = P99.9, y = year), color = "blue"))
ggplot(data = wtid) +
geom_point(mapping = aes(x = P99, y = year), color = "purple") +
geom_smooth(mapping = aes(x = P99, y = year), color = "purple")+
geom_point(mapping = aes(x = P99.5, y = year), color = "red") +
geom_smooth(mapping = aes(x = P99.5, y = year), color = "red")+
geom_point(mapping = aes(x = P99.9, y = year), color = "blue") +
geom_smooth(mapping = aes(x = P99.9, y = year), color = "blue")
ggplot(data = wtid) +
geom_point(mapping = aes(x = P99, y = year,label = "P99"), color = "purple") +
geom_smooth(mapping = aes(x = P99, y = year), color = "purple")+
geom_point(mapping = aes(x = P99.5, y = year), color = "red") +
geom_smooth(mapping = aes(x = P99.5, y = year), color = "red")+
geom_point(mapping = aes(x = P99.9, y = year), color = "blue") +
geom_smooth(mapping = aes(x = P99.9, y = year), color = "blue")
ggplot(data = wtid) +
geom_point(mapping = aes(x = year, y = P99,label = "P99"), color = "purple") +
geom_smooth(mapping = aes(x = year, y = P99), color = "purple")+
geom_point(mapping = aes(x = year, y = P99.5), color = "red") +
geom_smooth(mapping = aes(x = year, y = P99.5), color = "red")+
geom_point(mapping = aes(x = year, y = P99.9), color = "blue") +
geom_smooth(mapping = aes(x = year, y = P99.9), color = "blue")+
labs(title = "percentile against time", x = "year", y = "percentile")
ggplot(data = wtid) +
geom_point(mapping = aes(x = year, y = P99), color = "purple") +
geom_smooth(mapping = aes(x = year, y = P99), color = "purple")+
geom_point(mapping = aes(x = year, y = P99.5), color = "red") +
geom_smooth(mapping = aes(x = year, y = P99.5), color = "red")+
geom_point(mapping = aes(x = year, y = P99.9), color = "blue") +
geom_smooth(mapping = aes(x = year, y = P99.9), color = "blue")+
labs(title = "percentile against time", x = "year", y = "percentile")
ggplot(data = wtid) +
geom_point(mapping = aes(x = year, y = P99), color = "purple") +
geom_smooth(mapping = aes(x = year, y = P99), color = "purple")+
geom_point(mapping = aes(x = year, y = P99.5), color = "red") +
geom_smooth(mapping = aes(x = year, y = P99.5), color = "red")+
geom_point(mapping = aes(x = year, y = P99.9), color = "blue") +
geom_smooth(mapping = aes(x = year, y = P99.9), color = "blue")+
labs(title = "percentile against time", x = "year", y = "percentile")+
scale_shape_discrete(name  ="Payer",
breaks=c("Female", "Male"),
labels=c("Woman", "Man"))
ggplot(data = wtid) +
geom_point(mapping = aes(x = year, y = P99), color = "purple") +
geom_smooth(mapping = aes(x = year, y = P99), color = "purple",labels = "1")+
geom_point(mapping = aes(x = year, y = P99.5), color = "red") +
geom_smooth(mapping = aes(x = year, y = P99.5), color = "red")+
geom_point(mapping = aes(x = year, y = P99.9), color = "blue") +
geom_smooth(mapping = aes(x = year, y = P99.9), color = "blue")+
labs(title = "percentile against time", x = "year", y = "percentile")
ggplot(data = wtid) +
geom_point(mapping = aes(x = year, y = P99), color = "purple",labels = "1") +
geom_smooth(mapping = aes(x = year, y = P99), color = "purple")+
geom_point(mapping = aes(x = year, y = P99.5), color = "red") +
geom_smooth(mapping = aes(x = year, y = P99.5), color = "red")+
geom_point(mapping = aes(x = year, y = P99.9), color = "blue") +
geom_smooth(mapping = aes(x = year, y = P99.9), color = "blue")+
labs(title = "percentile against time", x = "year", y = "percentile")
#library(ggplot2)
ggplot(data = wtid) +
geom_point(mapping = aes(x = year, y = P99), color = "purple") +
geom_smooth(mapping = aes(x = year, y = P99), color = "purple")+
geom_point(mapping = aes(x = year, y = P99.5), color = "red") +
geom_smooth(mapping = aes(x = year, y = P99.5), color = "red")+
geom_point(mapping = aes(x = year, y = P99.9), color = "blue") +
geom_smooth(mapping = aes(x = year, y = P99.9), color = "blue")+
labs(title = "percentile against time", x = "year", y = "percentile")
#library(ggplot2)
ggplot(data = wtid) +
geom_point(mapping = aes(x = year, y = P99), color = "purple") +
geom_smooth(mapping = aes(x = year, y = P99), color = "purple")+
geom_point(mapping = aes(x = year, y = P99.5), color = "red") +
geom_smooth(mapping = aes(x = year, y = P99.5), color = "red")+
geom_point(mapping = aes(x = year, y = P99.9), color = "blue") +
geom_smooth(mapping = aes(x = year, y = P99.9), color = "blue")+
labs(title = "percentile against time", x = "year", y = "percentile")
legend("topleft",c("Manhattan","Brooklyn"),col=c("blue","red"),pch=1)
#library(ggplot2)
ggplot(data = wtid) +
geom_point(mapping = aes(x = year, y = P99), color = "purple") +
geom_smooth(mapping = aes(x = year, y = P99), color = "purple")+
geom_point(mapping = aes(x = year, y = P99.5), color = "red") +
geom_smooth(mapping = aes(x = year, y = P99.5), color = "red")+
geom_point(mapping = aes(x = year, y = P99.9), color = "blue") +
geom_smooth(mapping = aes(x = year, y = P99.9), color = "blue")+
labs(title = "percentile against time", x = "year", y = "percentile")+
legend("topleft",c("Manhattan","Brooklyn"),col=c("blue","red"),pch=1)
#library(ggplot2)
ggplot(data = wtid) +
geom_point(mapping = aes(x = year, y = P99), color = "purple") +
geom_smooth(mapping = aes(x = year, y = P99), color = "purple")+
geom_point(mapping = aes(x = year, y = P99.5), color = "red") +
geom_smooth(mapping = aes(x = year, y = P99.5), color = "red")+
geom_point(mapping = aes(x = year, y = P99.9), color = "blue") +
geom_smooth(mapping = aes(x = year, y = P99.9), color = "blue")+
labs(title = "percentile against time", x = "year", y = "percentile")
exponent.est_ratio <- function(P99,P99.9){
a = 1 - log(10)/log(P99/P99.9)
return a
exponent.est_ratio <- function(P99,P99.9){
a = 1 - log(10)/log(P99/P99.9)
return (a)
}
exponent.est_ratio(P99=1e6,P99.9=1e7)
A <- matrix(rnorm(25),5,5)<br />
A[10] <- NA<br />
apply(A, 1, quantile, seq(0, 1, 0.1), na.rm = TRUE)
A <- matrix(rnorm(25),5,5)
A[10] <- NA
apply(A, 1, quantile, seq(0, 1, 0.1), na.rm = TRUE)
exponent.est_ratio <- function(P99,P99.9){
a = sapply(P99, 2, 1 - log(10)/log(a1/a2),a2=P99.9)
return (a)
}
exponent.est_ratio(P99=1e6,P99.9=1e7)
exponent.est_ratio <- function(P99,P99.9){
a = apply(P99, 2, 1 - log(10)/log(a1/a2),a2=P99.9)
return (a)
}
exponent.est_ratio(P99=1e6,P99.9=1e7)
exponent.est_ratio <- function(P99,P99.9){
a = apply(P99, 2, 1 - log(10)/log(P99/a2),a2=P99.9)
return (a)
}
exponent.est_ratio(P99=1e6,P99.9=1e7)
exponent.est_ratio <- function(P99,P99.9){
a = apply(P99, 2, function(a1,a2) 1 - log(10)/log(a1/a2),a2=P99.9)
return (a)
}
exponent.est_ratio(P99=1e6,P99.9=1e7)
exponent.est_ratio <- function(P99,P99.9){
P = rbind(P99,P99.9)
a = apply(P, 1, function(a) 1 - log(10)/log(a[1]/a[2]))
return (a)
}
exponent.est_ratio(P99=1e6,P99.9=1e7)
exponent.est_ratio <- function(P99,P99.9){
P = rbind(P99,P99.9)
a = apply(P, 2, function(a) 1 - log(10)/log(a[1]/a[2]))
return (a)
}
exponent.est_ratio(P99=1e6,P99.9=1e7)
a <- exponent.est_ratio(wtid$P99,wtid$P99.9)
wtid <- rbind(wtid, a=exponent.est_ratio(wtid$P99,wtid$P99.9))
ggplot(data = wtid) +
geom_point(mapping = aes(x = year, y = a), color = "purple") +
geom_smooth(mapping = aes(x = year, y = a), color = "purple")
wtid <- rbind(wtid, a=exponent.est_ratio(wtid$P99,wtid$P99.9))
wtid <- rbind(wtid, a=exponent.est_ratio(wtid$P99,wtid$P99.9))
dim(wtid)
wtid <- read.csv("wtid-report.csv", header = TRUE)
wtid <- data.frame(year=wtid$Year,P99=wtid$P99.income.threshold,
P99.5=wtid$P99.5.income.threshold,
P99.9=wtid$P99.9.income.threshold)
wtid2 <- cbind(wtid, a=exponent.est_ratio(wtid$P99,wtid$P99.9))
dim(wtid2)
wtid2 <- cbind(wtid, a=exponent.est_ratio(wtid$P99,wtid$P99.9))
ggplot(data = wtid2) +
geom_point(mapping = aes(x = year, y = a), color = "purple") +
geom_smooth(mapping = aes(x = year, y = a), color = "purple")
wtid2 <- cbind(wtid, a=exponent.est_ratio(wtid$P99,wtid$P99.9))
ggplot(data = wtid2) +
geom_point(mapping = aes(x = year, y = a)) +
geom_smooth(mapping = aes(x = year, y = a))
# exponent.est_ratio <- function(P99,P99.9){
#   P = rbind(P99,P99.9)
#   a = apply(P, 2, function(a) 1 - log(10)/log(a[1]/a[2]))
#   return (a)
# }
exponent.est_ratio <- function(P99,P99.9){
return (1 - log(10)/log(P99/P99.9)
}
# exponent.est_ratio <- function(P99,P99.9){
#   P = rbind(P99,P99.9)
#   a = apply(P, 2, function(a) 1 - log(10)/log(a[1]/a[2]))
#   return (a)
# }
exponent.est_ratio <- function(P99,P99.9){
return (1 - log(10)/log(P99/P99.9))
}
exponent.est_ratio(P99=1e6,P99.9=1e7)
a=exponent.est_ratio(wtid$P99,wtid$P99.9)
wtid2 <- cbind(wtid, a)
ggplot(data = wtid2) +
geom_point(mapping = aes(x = year, y = a)) +
geom_smooth(mapping = aes(x = year, y = a))
A
a
