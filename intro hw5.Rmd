---
title: "Homework #5"
author: "Fan Yang, fy2232"
date: "December 8, 2017"
output:
  pdf_document: default
  html_document: default
---

# Part I

##1. 
```{r}
nodes <- read.csv("ckm_nodes.csv", header = T, as.is = T)

sum(na.omit(nodes$adoption_date) < Inf)
sum(na.omit(nodes$adoption_date)==Inf)
length(nodes$adoption_date) - length(na.omit(nodes$adoption_date))
```

##2. 

```{r}
ind.notNA <- complete.cases(nodes$adoption_date)
ind.notNA <- seq(1:nrow(nodes))[ind.notNA]
length(ind.notNA)
nodes <- nodes[ind.notNA,]
```

##3.
```{r}
num_mon <- table(nodes$adoption_date)[-18]
plot(num_mon,type = 'b',ylab="number begin prescribing") 
plot(cumsum(num_mon),type = 'b',ylab="total number prescribing")

```

##4.
```{r}
begin2 <- nodes$adoption_date<=2
begin2 <- seq(1:nrow(nodes))[begin2]
begin2
begin14 <- nodes$adoption_date>14
begin14 <- seq(1:nrow(nodes))[begin14]
begin14
```
##5.
```{r}
adopters <- function(month, not.yet = FALSE){
  index <- seq(1:nrow(nodes))
  late <- index[nodes$adoption_date>month]
  early <- index[nodes$adoption_date==month]
  if(not.yet){
    return(late)
  }else{
    return(early)
  }
}
adopters(2)
length(adopters(2))
length(adopters(month = 14, not.yet = TRUE))
```

# Part II
i.
